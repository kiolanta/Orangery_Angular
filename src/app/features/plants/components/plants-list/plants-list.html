<div class="plants-container">
  <div class="page-header">
    <div>
      <h1>üå± Plants Management</h1>
      <p class="subtitle">Manage your plants collection</p>
    </div>
    <div style="display: flex; gap: 1rem; align-items: center;">
      <button class="btn-add" (click)="openAddForm()">
        <span class="btn-icon">+</span>
        Add New Plant
      </button>
      <a routerLink="care-journal" class="btn-add btn-care-journal">
        <span class="btn-icon">üìù</span>
        –ñ—É—Ä–Ω–∞–ª –¥–æ–≥–ª—è–¥—É
      </a>
    </div>
  </div>

  <!-- Filters Panel -->
  <div class="filters-panel" *ngIf="!isLoading && !error && plants.length > 0">
    <div class="filters-content">
      <div class="filter-group">
        <label for="search">üîç –ü–æ—à—É–∫ –∑–∞ –Ω–∞–∑–≤–æ—é</label>
        <input
          id="search"
          type="text"
          [(ngModel)]="searchTerm"
          (ngModelChange)="onSearchChange()"
          placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ä–æ—Å–ª–∏–Ω–∏..."
          class="filter-input"
        />
      </div>

      <div class="filter-group">
        <label for="location">üìç –§—ñ–ª—å—Ç—Ä –∑–∞ –ª–æ–∫–∞—Ü—ñ—î—é</label>
        <select
          id="location"
          [(ngModel)]="selectedLocationId"
          (ngModelChange)="onLocationFilterChange()"
          class="filter-select"
        >
          <option [ngValue]="null">–í—Å—ñ –ª–æ–∫–∞—Ü—ñ—ó</option>
          <option *ngFor="let location of locations" [ngValue]="location.id">
            {{ location.name }}
          </option>
        </select>
      </div>

      <div class="filter-actions">
        <button class="btn-clear-filters" (click)="clearFilters()" *ngIf="searchTerm || selectedLocationId">
          ‚úñ –û—á–∏—Å—Ç–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏
        </button>
        <span class="results-count">
          –ó–Ω–∞–π–¥–µ–Ω–æ: <strong>{{ filteredPlants.length }}</strong> –∑ {{ plants.length }}
        </span>
      </div>
    </div>
  </div>

  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Loading plants...</p>
  </div>

  <div *ngIf="error" class="error-card">
    <p>{{ error }}</p>
    <button (click)="loadPlants()" class="btn-retry">Try Again</button>
  </div>

  <div *ngIf="!isLoading && !error" class="plants-content">
    <div *ngIf="filteredPlants.length === 0 && plants.length === 0" class="no-data">
      <div class="no-data-icon">üåø</div>
      <p>No plants found</p>
      <button class="btn-add-first" (click)="openAddForm()">Add Your First Plant</button>
    </div>

    <div *ngIf="filteredPlants.length === 0 && plants.length > 0" class="no-data">
      <div class="no-data-icon">üîç</div>
      <p>–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∑–∞ –≤–∞—à–∏–º –∑–∞–ø–∏—Ç–æ–º</p>
      <button class="btn-clear-filters" (click)="clearFilters()">–û—á–∏—Å—Ç–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</button>
    </div>

    <div *ngIf="filteredPlants.length > 0" class="table-card">
      <table class="plants-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Planting Date</th>
            <th>Location</th>
            <th>Species</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let plant of filteredPlants">
            <td><span class="id-badge">{{ plant.id }}</span></td>
            <td><strong>{{ plant.name }}</strong></td>
            <td>{{ plant.plantingDate }}</td>
            <td>{{ getLocationName(plant.locationId) }}</td>
            <td>{{ getSpeciesName(plant.speciesId) }}</td>
            <td>
              <div class="action-buttons">
                <button class="btn-icon-action btn-edit" (click)="openEditForm(plant)" title="Edit">
                  ‚úèÔ∏è
                </button>
                <button class="btn-icon-action btn-delete" (click)="deletePlant(plant.id)" title="Delete">
                  üóëÔ∏è
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<app-plant-form 
  *ngIf="showForm"
  [plant]="selectedPlant"
  [locations]="locations"
  [species]="species"
  (formSubmit)="onFormSubmit($event)"
  (formCancel)="closeForm()">
</app-plant-form>

